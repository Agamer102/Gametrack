{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}Update{% endblock %}</h1>
{% endblock %}

{% block content %}
<div class="card mb-3">
    {% for result in results %}
    {% if loop.index <= 20 %}
      {% if result.steam_appid  and result.vndbid %}
      <div class="row g-0">
        <div class="col-md-4">
          <img src="https://steamcdn-a.akamaihd.net/steam/apps/{{ result.steam_appid }}/header.jpg" class="img-fluid rounded-start" alt="...">
        </div>
        <div class="col-md-8">
          <div class="card-body">
            <h5 class="card-title">{{ result.name }}</h5>
            <p class="card-text">Steam AppID {{ result.steam_appid }}</p>
            <p class="card-text">VNDB ID {{ result.vndbid }}</p>
      {% elif result.steam_appid %}
      <div class="row g-0">
        <div class="col-md-4">
          <img src="https://steamcdn-a.akamaihd.net/steam/apps/{{ result.steam_appid }}/header.jpg" class="img-fluid rounded-start" alt="...">
        </div>
        <div class="col-md-8">
          <div class="card-body">
            <h5 class="card-title">{{ result.name }}</h5>
            <p class="card-text">Steam AppID {{ result.steam_appid }}</p>
      {% elif result.vndbid %}
      <div class="row g-0">
        <div class="col-md-4">
          <img src="" class="img-fluid rounded-start" alt="...">
        </div>
        <div class="col-md-8">
          <div class="card-body">
            <h5 class="card-title">{{ result.title_rm if result.title_rm else result.title_en }}</h5>
            <p class="card-text">Steam AppID {{ result.vndbid }}</p>
      {% endif %}
            <button 
            class="btn btn-secondary" 
            data-bs-toggle="modal" 
            data-bs-target="#updateGameModal" 
            data-bs-gameid="{{ result.id }}" 
            data-bs-gamename="{{ result.name if result.name is not none else result.title_rm }}" 
            data-bs-gamesteamid="{{ result.steam_appid if result.steam_appid is not none else '' }}"
            data-bs-gamevndbid="{{ result.vndbid if result.vndbid is not none else '' }}"
            data-bs-gametime="0"
            data-bs-gamerating="''">
              Add
            </button>
          </div>
        </div>
      </div>
    {% endif %}
    {% endfor %}
    {% if results|length > 20 %}
    <p>{{ results|length - 20 }} more results available</p>
    {% endif %}
</div>
{% endblock %}